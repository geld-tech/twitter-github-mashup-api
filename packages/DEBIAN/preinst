#!/bin/sh
set -e

echo "Pre-Installation Macro"

case "$1" in
	install)
		;;
	upgrade)
		echo -n "Stopping service __PACKAGE_NAME__ ..."
		systemctl stop __PACKAGE_NAME__ || true
		echo " OK"
		echo ""
		if [ -f __PACKAGE_DIR__/config/settings.cfg.template ]; then
			echo -n "Preserving local configuration before upgrade..."
			cp -p __PACKAGE_DIR__/config/settings.cfg /tmp/__PACKAGE_NAME__.settings.cfg
			echo " OK"
		fi
		;;
	*)
		echo "Pre-Installation Macro called with unknown argument \`$1'" >&2
		exit 1
		;;
esac

exit 0
